<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.19.2/URI.min.js"></script>
<style>
.test {
  display:inline-block;
  margin:10px;
}
</style>
<script>
var tests = [
    {
	title: 'Coral reefs and bleaching (implicit disableUI)',
	src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D37.96643%2C27.0601%2C0.48%2ClatLng%26t%3D0.75%26ps%3D0%26l%3Dbdrk%2Ccb%26bt%3D0.75%26et%3D0.75%26startDwell%3D0%26endDwell%3D0%26fps%3D10&width=250&height=150&format=png&fps=10&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&baseMapsNoLabels'
    },
    {
	title: 'Coral reefs and bleaching (minimalUI)',
	src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D267429%2C611221%2C904411%2C969523%2Cpts%26t%3D0%26ps%3D50%26l%3Dblsat%2Ccb%26bt%3D19950101%26et%3D20051231%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=250&height=150&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    },
    {
	title: 'Coral reefs and bleaching (minimalUI)',
	src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D267429%2C611221%2C904411%2C969523%2Cpts%26t%3D0%26ps%3D50%26l%3Dbdrk%2Ccb%26bt%3D20000101%26et%3D20051231%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=250&height=150&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    },
    {
        title: 'Coral reefs and bleaching 151px high (minimalUI)',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D267429%2C611221%2C904411%2C969523%2Cpts%26t%3D0%26ps%3D50%26l%3Dblsat%2Ccb%26bt%3D19950101%26et%3D20051231%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=250&height=151&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    },
    {
        title: 'Africa Landsat for Mobile Story (timestampOnlyUI)',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https://headless.earthtime.org/%23v%3D935046%2C711459%2C1404483%2C975517%2Cpts%26t%3D0%26ps%3D50%26l%3Dblsat%26bt%3D20100101%26et%3D20161231%26startDwell%3D0%26endDwell%3D1%26fps%3D30&width=640&height=360&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=1&fromScreenshot&timestampOnlyUI=true'
    },
    {
        title: 'Single frame fires with date and legend (minimalUI)',
        src: 'https://thumbnails-earthtime.cmucreatelab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D66511%2C260997%2C2059082%2C1381818%2Cpts%26t%3D18.1%26ps%3D0%26l%3Dblsat%2Cviirs%26bt%3D18.1%26et%3D18.1%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=1280&height=720&format=png&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    },
    {
        title: 'Fires at night with date bt/et',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%23v%3D568546%2C931906%2C939308%2C1140459%2Cpts%26t%3D0%26ps%3D50%26l%3Dbdrk%2Cviirs%26bt%3D20140917%26et%3D20141017%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=1280&height=720&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    },
    {
        title: 'TSIP single frame (timestampOnlyUI)',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https://headless.earthtime.org/%23v%3D4.56342%2C0%2C1.01%2ClatLng%26ps%3D50%26l%3Dbdrk%2Cpure_earth_tsip_by_pollutants_top_7%26bt%3D20160101%26et%3D20161231%26startDwell%3D0%26endDwell%3D0&width=1280&height=720&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&timestampOnlyUI=true'
    },
    {
        title: 'Coral reefs and bleaching (minimalUI and forceLegend)',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D37.96643%2C27.0601%2C0.48%2ClatLng%26t%3D0.75%26ps%3D0%26l%3Dbdrk%2Ccb%26bt%3D0.75%26et%3D0.75%26startDwell%3D0%26endDwell%3D0%26fps%3D10&width=820&height=600&format=png&fps=10&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&baseMapsNoLabels&minimalUI=true&forceLegend=true'
    },
    {
        title: 'Coral reefs and bleaching (minimalUI and forceLegend and centerLegend)',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%2F%23v%3D37.96643%2C27.0601%2C0.48%2ClatLng%26t%3D0.75%26ps%3D0%26l%3Dbdrk%2Ccb%26bt%3D0.75%26et%3D0.75%26startDwell%3D0%26endDwell%3D0%26fps%3D10&width=820&height=600&format=png&fps=10&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&baseMapsNoLabels&minimalUI=true&forceLegend=true&centerLegend=true'
    },
    {
        title: 'Edgar Thomson Breathe Cam',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https://tiles.cmucreatelab.org/ecam/timemachines/westmifflin1/2020-05-28.timemachine/&width=256&height=144&startFrame=12577&format=mp4&fps=20&tileFormat=mp4&startDwell=0&endDwell=0&boundsLTRB=1715.5301190916311,1337.447788486891,2684.441934216162,1881.7802688939305&labelsFromDataset&nframes=22'
    },
    {
        title: 'Sea-level-rise plus landsat',
        src: 'https://thumbnails-v2.createlab.org/thumbnail?root=https%3A%2F%2Fheadless.earthtime.org%23v%3D1359018%2C817444%2C1371426%2C824424%2Cpts%26t%3D0%26ps%3D50%26l%3Dblsat%2Cslr4%26bt%3D0.03%26et%3D0.83%26startDwell%3D0%26endDwell%3D0%26fps%3D30&width=1280&height=720&format=mp4&fps=30&tileFormat=mp4&startDwell=0&endDwell=0&fromScreenshot&minimalUI'
    }
];

function thumbnail_media_type(url) {
    var fields = url.split('&');
    if (fields.indexOf('format=png') >= 0 || fields.indexOf('format=jpg') >= 0) {
	return 'img';
    } else {
	return 'video';
    }
}

function url_prefix(url) {
    return URI(url).protocol() + '://' + URI(url).hostname();
}

function url_relative(url) {
    return URI(url).relativeTo(url_prefix(url)).toString();
}

function init() {
    console.log('init');
    for (var i = 0; i < tests.length; i++) {
	var test = tests[i];
	var title = test.title;
	var node;
	var media_type = thumbnail_media_type(test.src);

	$("body").append(`<h2>${i} ${title} (${media_type})</h2>`);
	var prefixes = [url_prefix(test.src), url_prefix(document.location)];
	for (var j = 0; j < prefixes.length; j++) {
	    var src = prefixes[j] + "/" + url_relative(test.src);
	    if (j == 1) {
		src += `&testepoch=${new Date().getTime()}`;
	    }
	    var host = URI(prefixes[j]).host();
	    var html = $('body').append(`<div class="test">` +
					`  <${media_type} src="${src}" autoplay loop muted style="max-width:250px"></${media_type}>` +
					`<br>${host}</div>`);
	}
    }
}

$(init);
</script>

</head>
<body>

<!--
<div class="test">
<video src="thumbnail?root=http://explorables.cmucreatelab.org/environmental-timemachines/shenango-20141005-20141006-tm/&boundsLTRB=2084.88990915391,1273.0414920286516,3791.489909153904,2519.6414920286475&width=320&height=240&frameTime=876.8333333333334&nframes=100&format=mp4&tileFormat=mp4&labels=2014-10-06%2009:30:31&recompute" autoplay="autoplay" loop="loop"></video><br>
100-frame video of Shenango with static label
</div>

<div class="test">
<img src="thumbnail?root=http://explorables.cmucreatelab.org/environmental-timemachines/shenango-20141005-20141006-tm/&boundsLTRB=2084.88990915391,1273.0414920286516,3791.489909153904,2519.6414920286475&width=320&height=240&frameTime=876.8333333333334&nframes=10&format=gif&tileFormat=mp4&labels=2014-10-06%2009:30:31&recompute"><br>
10-frame GIF of Shenango with static label
</div>

<div class="test">
<img src="thumbnail?root=http://explorables.cmucreatelab.org/environmental-timemachines/shenango-20141005-20141006-tm/&boundsLTRB=2084.88990915391,1273.0414920286516,3791.489909153904,2519.6414920286475&width=320&height=240&frameTime=876.8333333333334&format=jpg&tileFormat=mp4&labels=2014-10-06%2009:30:31&recompute"><br>
Single-frame JPG of Shenango with static label
</div>

<div class="test">
<img src="thumbnail?root=http://explorables.cmucreatelab.org/environmental-timemachines/shenango-20141005-20141006-tm/&boundsLTRB=2084.88990915391,1273.0414920286516,3791.489909153904,2519.6414920286475&width=320&height=240&frameTime=876.8333333333334&format=png&tileFormat=mp4&labels=2014-10-06%2009:30:31&recompute"><br>
Single-frame PNG of Shenango with static label
</div>

<div class="test">
<img src="thumbnail?root=http://earthengine.google.org/timelapse/data/20130507&boundsLTRB=-1070418.6821624064,661176.8681517515,1950212.7967361556,744089.7881861039&width=146&height=101&frameTime=0&recompute"><br>
World JPG from Earth Timelapse
</div>
    -->

</body>
</html>
